<html>
<head>
<title>RPi/GPS/IMU</title>
<script src="/jquery-3.4.1.min.js"></script>
</head>
<body>
<table>
<tr><td colspan=2 align=center id="msg">Loading...</td><tr>
<tr><th align="right">Latitude:</th><td id="lat" align="right"></td></tr>
<tr><th align="right">Longitude:</th><td id="lon" align="right"></td></tr>
<tr><th align="right">Altitude:</th><td id="alt" align="right"></td></tr>
<tr><td colspan=2 align=center><i><p id="time"></p></i></td><tr>
</table>
<script>
var refresh=15000;
$(document).ready(function()
{
  setInterval(function() {
  $.ajax({
    datatype: "json",
    url: "/gps",
    success: function(data)
    {
      var obj = JSON.parse(data);
      if (typeof obj.lat !== 'undefined') {
        $('#lat').text(obj.lat);
      } else {
        $('#lat').text("--");
      }
      if (typeof obj.lon !== 'undefined') {
        $('#lon').text(obj.lon);
      } else {
        $('#lon').text("--");
      }
      if (typeof obj.alt !== 'undefined') {
        $('#alt').text(obj.alt);
      } else {
        $('#alt').text("--");
      }
      $('#msg').text("");
      if (typeof obj.time !== 'undefined') {
        $('#time').text(obj.time.replace('T', ' ').split('.')[0]);
      } else {
        $('#time').text("--");
      }
    },
    error: function(xhr, status, error)
    {
      var errorMessage = xhr.status + ": " + xhr.statusText;
      $('#msg').text("ERROR: " + errorMessage);
    }
});
}, refresh);
});
</script>
</body>
</html>
